<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ™ãƒ“ãƒ¼ã‚·ãƒƒã‚¿ãƒ¼ï¼ˆä¸€æ™‚é ã‹ã‚Šï¼‰åˆ©ç”¨å†…è¨³æ›¸</title>
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'MS Gothic', monospace;
            font-size: 12px;
            line-height: 1.4;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
            display: flex;
        }

        /* ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ */
        .toolbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: white;
            border-bottom: 1px solid #ddd;
            padding: 10px 20px;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .toolbar button {
            padding: 8px 16px;
            border: 1px solid #ddd;
            background: white;
            cursor: pointer;
            border-radius: 4px;
            font-size: 12px;
        }

        .toolbar button:hover {
            background: #f0f0f0;
        }

        .toolbar button.active {
            background: #007acc;
            color: white;
        }

        .toolbar select {
            padding: 6px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 12px;
        }

        .toolbar-divider {
            height: 20px;
            width: 1px;
            background: #ddd;
        }

        /* ã‚µã‚¤ãƒ‰ãƒ‘ãƒãƒ« */
        .sidebar {
            position: fixed;
            top: 60px;
            left: 0;
            width: 300px;
            height: calc(100vh - 60px);
            background: white;
            border-right: 1px solid #ddd;
            padding: 20px;
            overflow-y: auto;
            transform: translateX(-100%);
            transition: transform 0.3s ease;
            z-index: 999;
        }

        .sidebar.open {
            transform: translateX(0);
        }

        .sidebar h3 {
            margin: 0 0 15px 0;
            font-size: 14px;
            font-weight: bold;
        }

        .sidebar .setting-group {
            margin-bottom: 20px;
        }

        .sidebar .setting-group label {
            display: block;
            margin-bottom: 5px;
            font-size: 12px;
            font-weight: bold;
        }

        .sidebar .setting-group select,
        .sidebar .setting-group input {
            width: 100%;
            padding: 6px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 12px;
        }

        .sidebar .margin-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        /* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ */
        .main-content {
            margin-top: 60px;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            transition: margin-left 0.3s ease;
            gap: 40px;
        }

        .main-content.sidebar-open {
            margin-left: 300px;
        }

        /* ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒ†ãƒŠ */
        .page-container {
            background: white;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            position: relative;
            transform-origin: top center;
            transition: transform 0.2s ease;
            display: block;
        }

        /* A4ãƒšãƒ¼ã‚¸ã‚µã‚¤ã‚º */
        .page-container.a4-portrait {
            width: 210mm;
            min-height: 297mm;
            max-height: 297mm;
            padding: var(--page-margin-top, 20mm) var(--page-margin-right, 20mm) var(--page-margin-bottom, 20mm) var(--page-margin-left, 20mm);
            overflow: hidden;
            page-break-after: always;
        }

        .page-container.a4-landscape {
            width: 297mm;
            min-height: 210mm;
            max-height: 210mm;
            padding: var(--page-margin-top, 20mm) var(--page-margin-right, 20mm) var(--page-margin-bottom, 20mm) var(--page-margin-left, 20mm);
            overflow: hidden;
            page-break-after: always;
        }

        /* ãƒšãƒ¼ã‚¸åˆ†å‰²ã®ãŸã‚ã®è¿½åŠ ã‚¹ã‚¿ã‚¤ãƒ« */
        .page-overflow {
            height: auto !important;
            max-height: none !important;
            overflow: visible !important;
        }

        .page-content {
            height: 100%;
            overflow: hidden;
        }

        /* ãƒ†ãƒ¼ãƒ–ãƒ«åˆ†å‰²ç”¨ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .table-continuation {
            margin-top: 0;
        }

        .table-continuation thead {
            background-color: #f0f0f0;
        }

        /* ãƒšãƒ¼ã‚¸åˆ†å‰²æ™‚ã®è¦ç´ åˆ¶å¾¡ */
        .avoid-break {
            page-break-inside: avoid;
        }

        .break-before {
            page-break-before: always;
        }

        /* ã‚ºãƒ¼ãƒ  */
        .zoom-50 { transform: scale(0.5); }
        .zoom-75 { transform: scale(0.75); }
        .zoom-100 { transform: scale(1); }
        .zoom-125 { transform: scale(1.25); }
        .zoom-150 { transform: scale(1.5); }

        /* ãƒšãƒ¼ã‚¸ç•ªå·è¡¨ç¤º */
        .page-number-display {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
        }

        /* ãƒ•ã‚©ãƒ¼ãƒ ã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆæ—¢å­˜ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ç¶™æ‰¿ï¼‰ */
        .header {
            text-align: center;
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 20px;
        }
        
        .year-field {
            display: inline-block;
            margin-left: 20px;
            font-size: 14px;
        }
        
        .form-section {
            margin-bottom: 15px;
        }
        
        .applicant-info {
            border: 2px solid black;
            padding: 5px;
            margin-bottom: 10px;
        }
        
        .applicant-info input {
            border: none;
            border-bottom: 1px solid black;
            background: transparent;
            width: 200px;
            font-size: 12px;
            font-family: inherit;
        }
        
        .child-info {
            margin-left: 20px;
        }
        
        .child-info input {
            border: none;
            border-bottom: 1px solid black;
            background: transparent;
            width: 200px;
            font-size: 12px;
            font-family: inherit;
        }
        
        .notes-box {
            border: 1px solid black;
            padding: 10px;
            margin-bottom: 15px;
            background-color: #f9f9f9;
        }
        
        .notes-box ul {
            margin: 0;
            padding-left: 20px;
        }
        
        .usage-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        
        .usage-table th,
        .usage-table td {
            border: 1px solid black;
            padding: 3px 5px;
            text-align: center;
            font-size: 11px;
        }
        
        /* ã™ã¹ã¦ã®å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®åŸºæœ¬ã‚¹ã‚¿ã‚¤ãƒ« */
        .usage-table input {
            border: 1px solid #ccc;
            background: white;
            font-family: inherit;
            font-size: 11px;
            padding: 2px;
        }
        
        .usage-table th {
            background-color: #e6e6e6;
            font-weight: bold;
        }
        
        .date-section {
            border: 2px solid black;
            padding: 5px;
            margin-bottom: 10px;
        }
        
        .date-section input {
            border: none;
            border-bottom: 1px solid black;
            background: transparent;
            width: 50px;
            text-align: center;
            font-size: 12px;
            font-family: inherit;
        }
        
        .calculation-section {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 20px 0;
            font-size: 14px;
        }
        
        .calc-box {
            border: 2px solid black;
            padding: 5px 10px;
            min-width: 80px;
            text-align: center;
        }
        
        .calc-box input {
            border: none;
            background: transparent;
            text-align: center;
            width: 100%;
            font-size: 14px;
            font-family: inherit;
        }
        
        .subsidy-info {
            font-size: 10px;
            margin: 10px 0;
        }
        
        .payment-section {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-top: 20px;
        }
        
        .payment-box {
            border: 2px solid black;
            padding: 8px;
            text-align: center;
            min-width: 100px;
        }
        
        .payment-box.highlight {
            background-color: #ffff99;
        }
        
        .payment-box input {
            border: none;
            background: transparent;
            text-align: center;
            width: 100%;
            font-size: 12px;
            font-family: inherit;
        }
        
        .page-number {
            text-align: center;
            margin-top: 30px;
            font-size: 12px;
        }
        
        .time-range-input {
            width: 100%;
            text-align: center;
            box-sizing: border-box;
            font-size: 11px;
        }
        
        .duration-input {
            width: 100%;
            text-align: center;
            box-sizing: border-box;
            font-size: 11px;
        }
        
        .hour-input {
            width: 100%;
            max-width: 40px;
            text-align: center;
            box-sizing: border-box;
        }
        
        .minute-input {
            width: 100%;
            max-width: 40px;
            text-align: center;
            box-sizing: border-box;
        }
        
        .amount-input {
            width: 100%;
            text-align: right;
            box-sizing: border-box;
        }
        
        /* æ—¥ä¸­åˆ©ç”¨ã¨å¤œé–“åˆ©ç”¨ã®åˆ—å¹…ã‚’å‡ç­‰ã« */
        .usage-table {
            table-layout: auto;
        }
        
        /* å„åˆ—ã®å¹…ã‚’è¨­å®š */
        .usage-table td:nth-child(1) { width: 10%; }  /* åˆ©ç”¨æ—¥ */
        .usage-table td:nth-child(2) { width: 18%; } /* æ—¥ä¸­åˆ©ç”¨æ™‚é–“ */
        .usage-table td:nth-child(3) { width: 12%; } /* æ—¥ä¸­åˆ©ç”¨æ™‚é–“æ•° */
        .usage-table td:nth-child(4) { width: 18%; } /* å¤œé–“åˆ©ç”¨æ™‚é–“ */
        .usage-table td:nth-child(5) { width: 12%; } /* å¤œé–“åˆ©ç”¨æ™‚é–“æ•° */
        .usage-table td:nth-child(6) { width: 15%; } /* å®Ÿæ”¯æ‰•é¡ */

        /* å°åˆ·ã‚¹ã‚¿ã‚¤ãƒ« */
        @media print {
            .toolbar,
            .sidebar,
            .page-number-display {
                display: none !important;
            }

            body {
                background: white;
                margin: 0;
                padding: 0;
            }

            .main-content {
                margin: 0;
                padding: 0;
            }

            .page-container {
                box-shadow: none;
                margin: 0;
                transform: none !important;
                page-break-after: always;
            }

            .page-container:last-child {
                page-break-after: auto;
            }
            
            /* å°åˆ·æ™‚ã¯å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®æ ç·šã‚’éè¡¨ç¤º */
            .usage-table input,
            .info-input,
            .time-range-input,
            .duration-input,
            input[type="text"] {
                border: none !important;
                background: transparent !important;
            }
            
            /* å°åˆ·æ™‚ã¯ãƒ—ãƒ¬ã‚¤ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã‚’éè¡¨ç¤º */
            input::-webkit-input-placeholder {
                color: transparent !important;
            }
            input::-moz-placeholder {
                color: transparent !important;
            }
            input:-ms-input-placeholder {
                color: transparent !important;
            }
            input::placeholder {
                color: transparent !important;
            }

            /* å°åˆ·æ™‚ã®ãƒšãƒ¼ã‚¸ã‚µã‚¤ã‚ºã‚’æ­£ç¢ºã«è¨­å®š */
            @page {
                size: var(--print-page-size, A4) var(--print-orientation, portrait);
                margin: 0;
            }
        }

        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ */
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
            }

            .main-content.sidebar-open {
                margin-left: 0;
            }

            .page-container {
                width: 100%;
                min-width: 300px;
            }
        }
    </style>
</head>
<body>
    <!-- ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ -->
    <div class="toolbar">
        <button id="settingsBtn">âš™ï¸ è¨­å®š</button>
        <div class="toolbar-divider"></div>
        
        <label>ã‚ºãƒ¼ãƒ :</label>
        <select id="zoomSelect">
            <option value="50">50%</option>
            <option value="75">75%</option>
            <option value="100" selected>100%</option>
            <option value="125">125%</option>
            <option value="150">150%</option>
        </select>
        
        <div class="toolbar-divider"></div>
        
        <button id="printBtn">ğŸ–¨ï¸ å°åˆ·</button>
        <button id="previewBtn">ğŸ‘ï¸ å°åˆ·ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</button>
        <button id="paginateBtn">ğŸ“„ ãƒšãƒ¼ã‚¸åˆ†å‰²</button>
        
        <div class="toolbar-divider"></div>
        
        <span id="pageInfo">ãƒšãƒ¼ã‚¸ 1-2</span>
    </div>

    <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼è¨­å®šãƒ‘ãƒãƒ« -->
    <div class="sidebar" id="sidebar">
        <h3>ãƒšãƒ¼ã‚¸è¨­å®š</h3>
        
        <div class="setting-group">
            <label>ç”¨ç´™ã‚µã‚¤ã‚º:</label>
            <select id="paperSize">
                <option value="a4">A4</option>
                <option value="letter">Letter</option>
                <option value="legal">Legal</option>
            </select>
        </div>
        
        <div class="setting-group">
            <label>å°åˆ·æ–¹å‘:</label>
            <select id="orientation">
                <option value="portrait">ç¸¦</option>
                <option value="landscape">æ¨ª</option>
            </select>
        </div>
        
        <div class="setting-group">
            <label>ãƒãƒ¼ã‚¸ãƒ³ (mm):</label>
            <div class="margin-inputs">
                <input type="number" id="marginTop" placeholder="ä¸Š" value="20">
                <input type="number" id="marginRight" placeholder="å³" value="20">
                <input type="number" id="marginBottom" placeholder="ä¸‹" value="20">
                <input type="number" id="marginLeft" placeholder="å·¦" value="20">
            </div>
        </div>
        
        <div class="setting-group">
            <label>ãƒ˜ãƒƒãƒ€ãƒ¼:</label>
            <input type="text" id="headerText" placeholder="ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ†ã‚­ã‚¹ãƒˆ">
        </div>
        
        <div class="setting-group">
            <label>ãƒ•ãƒƒã‚¿ãƒ¼:</label>
            <input type="text" id="footerText" placeholder="ãƒ•ãƒƒã‚¿ãƒ¼ãƒ†ã‚­ã‚¹ãƒˆ">
        </div>
        
        <button onclick="applySettings()" style="width: 100%; margin-top: 20px;">è¨­å®šã‚’é©ç”¨</button>
    </div>

    <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <div class="main-content" id="mainContent">
        <!-- ãƒšãƒ¼ã‚¸1 -->
        <div class="page-container a4-portrait" id="page1">
            <div class="page-number-display">ãƒšãƒ¼ã‚¸ 1</div>
            
            <div class="header">
                ãƒ™ãƒ“ãƒ¼ã‚·ãƒƒã‚¿ãƒ¼ï¼ˆä¸€æ™‚é ã‹ã‚Šï¼‰åˆ©ç”¨å†…è¨³æ›¸
                <span class="year-field">ã€ä»¤å’Œ <input type="text" style="width: 30px;"> å¹´åº¦ã€‘</span>
            </div>
            
            <style>
                .info-section {
                    margin-bottom: 20px;
                }
                .info-row {
                    display: flex;
                    align-items: center;
                    margin-bottom: 10px;
                    gap: 30px;
                }
                .info-label {
                    font-weight: bold;
                    min-width: 80px;
                    white-space: nowrap;
                }
                .info-input {
                    border: none;
                    border-bottom: 2px solid black;
                    background: transparent;
                    flex: 1;
                    font-size: 14px;
                    font-family: inherit;
                    padding: 5px 0;
                }
            </style>
            
            <div class="info-section">
                <div class="info-row">
                    <div class="info-label">ç”³è«‹è€…å</div>
                    <input type="text" class="info-input">
                </div>
                <div class="info-row">
                    <div class="info-label">å…ç«¥å</div>
                    <input type="text" class="info-input">
                </div>
            </div>
            
            <div class="notes-box">
                <ul>
                    <li>7æ™‚ï½22æ™‚ã®åˆ©ç”¨ã¨22æ™‚ï½ç¿Œ7æ™‚ã®åˆ©ç”¨ã¯è¨˜è¼‰æ¬„ã‚’åˆ†ã‘ã¦è¨˜å…¥ã—ã¦ãã ã•ã„ã€‚</li>
                    <li>æ”¯æ‰•ã„ã«æ‰ä¸¦åŒºå­è‚²ã¦å¿œæ´åˆ¸ã‚’ä½¿ç”¨ã—ãŸåˆ©ç”¨åˆ†ã«ã¤ã„ã¦ã¯è£œåŠ©å¯¾è±¡å¤–ã§ã™ã€‚</li>
                    <li>å…¥ä¼šé‡‘ã€ä¼šè²»ã€ç™»éŒ²æ–™ã€äº¤é€šè²»ã€ã‚­ãƒ£ãƒ³ã‚»ãƒ«æ–™ã€ä¿é™ºæ–™ã€ãŠã‚€ã¤ä»£ç­‰ã®å®Ÿè²»ç­‰ã¯è£œåŠ©å¯¾è±¡å¤–ã§ã™ã€‚</li>
                </ul>
            </div>
            
            <div class="date-section">
                ä»¤å’Œ <input type="text" id="year" value="7"> å¹´ <input type="text" id="month" value="4"> æœˆåˆ†ã€€ã€€äº‹æ¥­è€…ã¸ã®æ”¯æ‰•é‡‘é¡ã‹ã‚‰ã€äº¤é€šè²»ã‚„ã‚¯ãƒ¼ãƒãƒ³ç­‰ã®å‰²å¼•ã‚’å·®ã—å¼•ã„ãŸã€ç´”ç„¶ãŸã‚‹ä¿è‚²æ–™ã‚’è¨˜è¼‰ã€‚
            </div>
            
            <table class="usage-table">
                <thead>
                    <tr>
                        <th rowspan="3">åˆ©ç”¨æ—¥</th>
                        <th colspan="6">åˆ©ç”¨æ™‚é–“</th>
                        <th rowspan="3">å®Ÿæ”¯æ‰•é¡</th>
                    </tr>
                    <tr>
                        <th colspan="3">æ—¥ä¸­åˆ©ç”¨ï¼ˆ7æ™‚ï½22æ™‚ï¼‰</th>
                        <th colspan="3">å¤œé–“åˆ©ç”¨ï¼ˆ22æ™‚ï½ç¿Œ7æ™‚ï¼‰</th>
                    </tr>
                    <tr>
                        <th colspan="2">æ™‚é–“</th>
                        <th>â—‹æ™‚é–“â—‹åˆ†</th>
                        <th colspan="2">æ™‚é–“</th>
                        <th>â—‹æ™‚é–“â—‹åˆ†</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- 10è¡Œã®ãƒ‡ãƒ¼ã‚¿å…¥åŠ›è¡Œ -->
                    <tr><td><input type="text" style="width: 100%;"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="9:00 ï½ 10:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="22:00 ï½ 23:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td><input type="text" class="amount-input"></td></tr>
                    <tr><td><input type="text" style="width: 100%;"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="9:00 ï½ 10:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="22:00 ï½ 23:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td><input type="text" class="amount-input"></td></tr>
                    <tr><td><input type="text" style="width: 100%;"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="9:00 ï½ 10:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="22:00 ï½ 23:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td><input type="text" class="amount-input"></td></tr>
                    <tr><td><input type="text" style="width: 100%;"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="9:00 ï½ 10:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="22:00 ï½ 23:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td><input type="text" class="amount-input"></td></tr>
                    <tr><td><input type="text" style="width: 100%;"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="9:00 ï½ 10:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="22:00 ï½ 23:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td><input type="text" class="amount-input"></td></tr>
                    <tr><td><input type="text" style="width: 100%;"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="9:00 ï½ 10:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="22:00 ï½ 23:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td><input type="text" class="amount-input"></td></tr>
                    <tr><td><input type="text" style="width: 100%;"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="9:00 ï½ 10:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="22:00 ï½ 23:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td><input type="text" class="amount-input"></td></tr>
                    <tr><td><input type="text" style="width: 100%;"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="9:00 ï½ 10:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="22:00 ï½ 23:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td><input type="text" class="amount-input"></td></tr>
                    <tr><td><input type="text" style="width: 100%;"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="9:00 ï½ 10:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="22:00 ï½ 23:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td><input type="text" class="amount-input"></td></tr>
                    <tr><td><input type="text" style="width: 100%;"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="9:00 ï½ 10:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="22:00 ï½ 23:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td><input type="text" class="amount-input"></td></tr>
                    <!-- åˆè¨ˆè¡Œ -->
                    <tr style="background-color: #e6e6e6;">
                        <td>æ—¥ä¸­åˆ©ç”¨æ™‚é–“åˆè¨ˆ</td>
                        <td colspan="2"></td>
                        <td><input type="text" class="duration-input"></td>
                        <td>å¤œé–“åˆ©ç”¨æ™‚é–“åˆè¨ˆ</td>
                        <td><input type="text" class="duration-input"></td>
                        <td>ï¿¥ <input type="text" class="amount-input" style="width: 80%;"></td>
                    </tr>
                    <tr style="background-color: #e6e6e6;">
                        <td>ä»–ãƒšãƒ¼ã‚¸å«ã‚€ç·è¨ˆ</td>
                        <td colspan="2"></td>
                        <td><input type="text" class="duration-input"></td>
                        <td>ä»–ãƒšãƒ¼ã‚¸å«ã‚€ç·è¨ˆ</td>
                        <td><input type="text" class="duration-input"></td>
                        <td>ï¿¥ <input type="text" class="amount-input" style="width: 80%;"></td>
                    </tr>
                </tbody>
            </table>
            
            <div class="calculation-section">
                <div>
                    <div style="font-size: 10px;">æ—¥ä¸­åˆ©ç”¨æ™‚é–“</div>
                    <div style="font-size: 10px;">(60åˆ†æœªæº€åˆ‡æ¨)</div>
                    <div class="calc-box">
                        <input type="text"> æ™‚é–“
                    </div>
                </div>
                <div>Ã—</div>
                <div>2,500å††</div>
                <div>+</div>
                <div>
                    <div style="font-size: 10px;">å¤œé–“åˆ©ç”¨æ™‚é–“</div>
                    <div style="font-size: 10px;">(60åˆ†æœªæº€åˆ‡æ¨)</div>
                    <div class="calc-box">
                        <input type="text"> æ™‚é–“
                    </div>
                </div>
                <div>Ã—</div>
                <div>3,500å††</div>
                <div>=</div>
                <div class="calc-box" style="background-color: #cce6ff;">
                    <div style="font-size: 10px;">è£œåŠ©åŸºæº–é¡</div>
                    ï¿¥ <input type="text">
                </div>
            </div>
            
            <div class="subsidy-info">
                â€»è£œåŠ©æ™‚é–“æ•°ã®ä¸Šé™ã¯å…ç«¥1äººã‚ãŸã‚Š1ãƒ¶æœˆå¹´åº¦å†…ã§<strong>144æ™‚é–“</strong><br>
                ï¼ˆå¤šèƒå…ã®å ´åˆã¯1äººã‚ãŸã‚Š<strong>288æ™‚é–“</strong>ï¼‰ã§ã™ã€‚
            </div>
            
            <div class="payment-section">
                <div style="display: flex; align-items: center; gap: 5px;">
                    <span style="background-color: red; color: white; padding: 2px 5px; font-size: 10px;">A</span>
                    <span>ã¨</span>
                    <span style="background-color: blue; color: white; padding: 2px 5px; font-size: 10px;">B</span>
                    <span>ã®</span>
                    <br>
                    <span style="font-size: 10px;">å°ã•ã„æ–¹ã®é‡‘é¡</span>
                </div>
                <div class="payment-box highlight">
                    <div style="font-size: 10px;">äº¤ä»˜è«‹æ±‚é¡</div>
                    ï¿¥ <input type="text">
                </div>
                <div class="payment-box">
                    <div style="font-size: 10px;">ä½¿ç”¨æ™‚é–“æ•°</div>
                    <input type="text"> æ™‚é–“
                </div>
            </div>
            
            <div class="page-number">1 ãƒšãƒ¼ã‚¸</div>
        </div>

        <!-- ãƒšãƒ¼ã‚¸2 -->
        <div class="page-container a4-portrait" id="page2">
            <div class="page-number-display">ãƒšãƒ¼ã‚¸ 2</div>
            
            <div class="date-section">
                ä»¤å’Œ <input type="text" id="year-page2-1" value="7"> å¹´ <input type="text" id="month-page2-1" value="4"> æœˆåˆ†
            </div>
            
            <table class="usage-table">
                <thead>
                    <tr>
                        <th rowspan="3">åˆ©ç”¨æ—¥</th>
                        <th colspan="6">åˆ©ç”¨æ™‚é–“</th>
                        <th rowspan="3">å®Ÿæ”¯æ‰•é¡</th>
                    </tr>
                    <tr>
                        <th colspan="3">æ—¥ä¸­åˆ©ç”¨ï¼ˆ7æ™‚ï½22æ™‚ï¼‰</th>
                        <th colspan="3">å¤œé–“åˆ©ç”¨ï¼ˆ22æ™‚ï½ç¿Œ7æ™‚ï¼‰</th>
                    </tr>
                    <tr>
                        <th colspan="2">æ™‚é–“</th>
                        <th>â—‹æ™‚é–“â—‹åˆ†</th>
                        <th colspan="2">æ™‚é–“</th>
                        <th>â—‹æ™‚é–“â—‹åˆ†</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- 12è¡Œã®ãƒ‡ãƒ¼ã‚¿å…¥åŠ›è¡Œ -->
                    <tr><td><input type="text" style="width: 100%;"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="9:00 ï½ 10:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="22:00 ï½ 23:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td><input type="text" class="amount-input"></td></tr>
                    <tr><td><input type="text" style="width: 100%;"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="9:00 ï½ 10:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="22:00 ï½ 23:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td><input type="text" class="amount-input"></td></tr>
                    <tr><td><input type="text" style="width: 100%;"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="9:00 ï½ 10:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="22:00 ï½ 23:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td><input type="text" class="amount-input"></td></tr>
                    <tr><td><input type="text" style="width: 100%;"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="9:00 ï½ 10:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="22:00 ï½ 23:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td><input type="text" class="amount-input"></td></tr>
                    <tr><td><input type="text" style="width: 100%;"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="9:00 ï½ 10:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="22:00 ï½ 23:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td><input type="text" class="amount-input"></td></tr>
                    <tr><td><input type="text" style="width: 100%;"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="9:00 ï½ 10:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="22:00 ï½ 23:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td><input type="text" class="amount-input"></td></tr>
                    <tr><td><input type="text" style="width: 100%;"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="9:00 ï½ 10:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="22:00 ï½ 23:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td><input type="text" class="amount-input"></td></tr>
                    <tr><td><input type="text" style="width: 100%;"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="9:00 ï½ 10:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="22:00 ï½ 23:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td><input type="text" class="amount-input"></td></tr>
                    <tr><td><input type="text" style="width: 100%;"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="9:00 ï½ 10:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="22:00 ï½ 23:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td><input type="text" class="amount-input"></td></tr>
                    <tr><td><input type="text" style="width: 100%;"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="9:00 ï½ 10:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="22:00 ï½ 23:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td><input type="text" class="amount-input"></td></tr>
                    <tr><td><input type="text" style="width: 100%;"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="9:00 ï½ 10:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="22:00 ï½ 23:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td><input type="text" class="amount-input"></td></tr>
                    <tr><td><input type="text" style="width: 100%;"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="9:00 ï½ 10:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="22:00 ï½ 23:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td><input type="text" class="amount-input"></td></tr>
                    <!-- åˆè¨ˆè¡Œ -->
                    <tr style="background-color: #e6e6e6;">
                        <td>æ—¥ä¸­åˆ©ç”¨æ™‚é–“åˆè¨ˆ</td>
                        <td colspan="2"></td>
                        <td><input type="text" class="duration-input"></td>
                        <td>å¤œé–“åˆ©ç”¨æ™‚é–“åˆè¨ˆ</td>
                        <td><input type="text" class="duration-input"></td>
                        <td>ï¿¥ <input type="text" class="amount-input" style="width: 80%;"></td>
                    </tr>
                </tbody>
            </table>
            
            <div class="date-section">
                ä»¤å’Œ <input type="text" id="year-page2-2" value="7"> å¹´ <input type="text" id="month-page2-2" value="5"> æœˆåˆ†
            </div>
            
            <table class="usage-table">
                <thead>
                    <tr>
                        <th rowspan="3">åˆ©ç”¨æ—¥</th>
                        <th colspan="6">åˆ©ç”¨æ™‚é–“</th>
                        <th rowspan="3">å®Ÿæ”¯æ‰•é¡</th>
                    </tr>
                    <tr>
                        <th colspan="3">æ—¥ä¸­åˆ©ç”¨ï¼ˆ7æ™‚ï½22æ™‚ï¼‰</th>
                        <th colspan="3">å¤œé–“åˆ©ç”¨ï¼ˆ22æ™‚ï½ç¿Œ7æ™‚ï¼‰</th>
                    </tr>
                    <tr>
                        <th colspan="2">æ™‚é–“</th>
                        <th>â—‹æ™‚é–“â—‹åˆ†</th>
                        <th colspan="2">æ™‚é–“</th>
                        <th>â—‹æ™‚é–“â—‹åˆ†</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- 7è¡Œã®ãƒ‡ãƒ¼ã‚¿å…¥åŠ›è¡Œ -->
                    <tr><td><input type="text" style="width: 100%;"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="9:00 ï½ 10:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="22:00 ï½ 23:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td><input type="text" class="amount-input"></td></tr>
                    <tr><td><input type="text" style="width: 100%;"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="9:00 ï½ 10:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="22:00 ï½ 23:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td><input type="text" class="amount-input"></td></tr>
                    <tr><td><input type="text" style="width: 100%;"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="9:00 ï½ 10:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="22:00 ï½ 23:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td><input type="text" class="amount-input"></td></tr>
                    <tr><td><input type="text" style="width: 100%;"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="9:00 ï½ 10:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="22:00 ï½ 23:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td><input type="text" class="amount-input"></td></tr>
                    <tr><td><input type="text" style="width: 100%;"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="9:00 ï½ 10:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="22:00 ï½ 23:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td><input type="text" class="amount-input"></td></tr>
                    <tr><td><input type="text" style="width: 100%;"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="9:00 ï½ 10:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="22:00 ï½ 23:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td><input type="text" class="amount-input"></td></tr>
                    <tr><td><input type="text" style="width: 100%;"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="9:00 ï½ 10:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td colspan="2"><input type="text" class="time-range-input" placeholder="22:00 ï½ 23:00"></td><td><input type="text" class="duration-input" placeholder="1æ™‚é–“00åˆ†"></td><td><input type="text" class="amount-input"></td></tr>
                    <!-- åˆè¨ˆè¡Œ -->
                    <tr style="background-color: #e6e6e6;">
                        <td>æ—¥ä¸­åˆ©ç”¨æ™‚é–“åˆè¨ˆ</td>
                        <td colspan="2"></td>
                        <td><input type="text" class="duration-input"></td>
                        <td>å¤œé–“åˆ©ç”¨æ™‚é–“åˆè¨ˆ</td>
                        <td><input type="text" class="duration-input"></td>
                        <td>ï¿¥ <input type="text" class="amount-input" style="width: 80%;"></td>
                    </tr>
                </tbody>
            </table>
            
            <div style="text-align: center; background-color: #ffff00; padding: 10px; margin: 20px 0; font-weight: bold;">
                è¨˜è¼‰ã™ã‚‹è¡ŒãŒä¸è¶³ã™ã‚‹å ´åˆã¯ã€ç¶šãã‚’2ãƒšãƒ¼ã‚¸ç›®ã¨åŒæ§˜ã«è¨˜è¼‰ã—ã¦ãã ã•ã„ã€‚
            </div>
            
            <div class="page-number">2 ãƒšãƒ¼ã‚¸</div>
        </div>
    </div>

    <script>
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let currentZoom = 100;
        let sidebarOpen = false;

        // DOMè¦ç´ ã®å–å¾—
        const settingsBtn = document.getElementById('settingsBtn');
        const sidebar = document.getElementById('sidebar');
        const mainContent = document.getElementById('mainContent');
        const zoomSelect = document.getElementById('zoomSelect');
        const printBtn = document.getElementById('printBtn');
        const previewBtn = document.getElementById('previewBtn');
        const paginateBtn = document.getElementById('paginateBtn');
        const pageInfo = document.getElementById('pageInfo');

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
        settingsBtn.addEventListener('click', toggleSidebar);
        zoomSelect.addEventListener('change', changeZoom);
        printBtn.addEventListener('click', printDocument);
        previewBtn.addEventListener('click', showPrintPreview);
        paginateBtn.addEventListener('click', paginateContent);

        // ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®é–‹é–‰
        function toggleSidebar() {
            sidebarOpen = !sidebarOpen;
            sidebar.classList.toggle('open', sidebarOpen);
            mainContent.classList.toggle('sidebar-open', sidebarOpen);
            settingsBtn.classList.toggle('active', sidebarOpen);
        }

        // ã‚ºãƒ¼ãƒ æ©Ÿèƒ½
        function changeZoom() {
            currentZoom = parseInt(zoomSelect.value);
            const pages = document.querySelectorAll('.page-container');
            pages.forEach(page => {
                page.className = page.className.replace(/zoom-\d+/, `zoom-${currentZoom}`);
            });
        }

        // è¨­å®šã®é©ç”¨
        function applySettings() {
            const paperSize = document.getElementById('paperSize').value;
            const orientation = document.getElementById('orientation').value;
            const marginTop = document.getElementById('marginTop').value;
            const marginRight = document.getElementById('marginRight').value;
            const marginBottom = document.getElementById('marginBottom').value;
            const marginLeft = document.getElementById('marginLeft').value;
            const headerText = document.getElementById('headerText').value;
            const footerText = document.getElementById('footerText').value;

            // ãƒšãƒ¼ã‚¸ã‚µã‚¤ã‚ºã¨ãƒãƒ¼ã‚¸ãƒ³ã®é©ç”¨
            const pages = document.querySelectorAll('.page-container');
            pages.forEach(page => {
                // ãƒšãƒ¼ã‚¸ã‚µã‚¤ã‚ºã‚¯ãƒ©ã‚¹ã®æ›´æ–°
                page.className = page.className.replace(/a4-(portrait|landscape)/, `${paperSize}-${orientation}`);
                
                // ãƒãƒ¼ã‚¸ãƒ³ã®é©ç”¨
                page.style.setProperty('--page-margin-top', `${marginTop}mm`);
                page.style.setProperty('--page-margin-right', `${marginRight}mm`);
                page.style.setProperty('--page-margin-bottom', `${marginBottom}mm`);
                page.style.setProperty('--page-margin-left', `${marginLeft}mm`);
            });

            // å°åˆ·è¨­å®šã®é©ç”¨
            document.documentElement.style.setProperty('--print-page-size', paperSize.toUpperCase());
            document.documentElement.style.setProperty('--print-orientation', orientation);

            // ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ»ãƒ•ãƒƒã‚¿ãƒ¼ã®è¿½åŠ ï¼ˆç°¡æ˜“å®Ÿè£…ï¼‰
            if (headerText || footerText) {
                addHeaderFooter(headerText, footerText);
            }

            alert('è¨­å®šãŒé©ç”¨ã•ã‚Œã¾ã—ãŸ');
        }

        // ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ»ãƒ•ãƒƒã‚¿ãƒ¼ã®è¿½åŠ 
        function addHeaderFooter(header, footer) {
            const pages = document.querySelectorAll('.page-container');
            pages.forEach(page => {
                // æ—¢å­˜ã®ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ»ãƒ•ãƒƒã‚¿ãƒ¼ã‚’å‰Šé™¤
                const existingHeader = page.querySelector('.custom-header');
                const existingFooter = page.querySelector('.custom-footer');
                if (existingHeader) existingHeader.remove();
                if (existingFooter) existingFooter.remove();

                // ãƒ˜ãƒƒãƒ€ãƒ¼ã®è¿½åŠ 
                if (header) {
                    const headerDiv = document.createElement('div');
                    headerDiv.className = 'custom-header';
                    headerDiv.style.cssText = 'position: absolute; top: 10mm; left: 0; right: 0; text-align: center; font-size: 10px; color: #666;';
                    headerDiv.textContent = header;
                    page.style.position = 'relative';
                    page.appendChild(headerDiv);
                }

                // ãƒ•ãƒƒã‚¿ãƒ¼ã®è¿½åŠ 
                if (footer) {
                    const footerDiv = document.createElement('div');
                    footerDiv.className = 'custom-footer';
                    footerDiv.style.cssText = 'position: absolute; bottom: 10mm; left: 0; right: 0; text-align: center; font-size: 10px; color: #666;';
                    footerDiv.textContent = footer;
                    page.style.position = 'relative';
                    page.appendChild(footerDiv);
                }
            });
        }

        // å°åˆ·æ©Ÿèƒ½
        function printDocument() {
            window.print();
        }

        // å°åˆ·ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
        function showPrintPreview() {
            // æ—¢ã«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã‹ã©ã†ã‹ã‚’ãƒã‚§ãƒƒã‚¯
            if (document.body.classList.contains('print-preview')) {
                exitPrintPreview();
                return;
            }

            // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¿½åŠ 
            const previewStyle = document.createElement('style');
            previewStyle.id = 'print-preview-style';
            previewStyle.textContent = `
                .print-preview .toolbar {
                    background: #333;
                    color: white;
                }
                .print-preview .sidebar {
                    display: none;
                }
                .print-preview .main-content {
                    margin-left: 0;
                    background: #666;
                    padding: 40px;
                }
                .print-preview .page-container {
                    margin-bottom: 40px;
                    box-shadow: 0 8px 16px rgba(0,0,0,0.3);
                }
                .print-preview .page-number-display {
                    background: rgba(0,0,0,0.8);
                }
            `;
            document.head.appendChild(previewStyle);

            // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã®ã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ 
            document.body.classList.add('print-preview');

            // ãƒœã‚¿ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’å¤‰æ›´
            previewBtn.textContent = 'ğŸ“„ ç·¨é›†ãƒ¢ãƒ¼ãƒ‰';
            
            // ã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚’é–‰ã˜ã‚‹
            if (sidebarOpen) {
                toggleSidebar();
            }
        }

        // å°åˆ·ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼çµ‚äº†
        function exitPrintPreview() {
            document.body.classList.remove('print-preview');
            const previewStyle = document.getElementById('print-preview-style');
            if (previewStyle) {
                previewStyle.remove();
            }
            previewBtn.textContent = 'ğŸ‘ï¸ å°åˆ·ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼';
        }

        // ãƒšãƒ¼ã‚¸åˆ†å‰²æ©Ÿèƒ½
        function paginateContent() {
            const pages = document.querySelectorAll('.page-container');
            let totalPages = 0;
            
            pages.forEach((page, index) => {
                const result = splitPageIfNeeded(page, index + 1);
                totalPages += result.pageCount;
            });
            
            updatePageInfo(totalPages);
            alert(`ãƒšãƒ¼ã‚¸åˆ†å‰²å®Œäº†: ${totalPages}ãƒšãƒ¼ã‚¸ã«åˆ†å‰²ã•ã‚Œã¾ã—ãŸ`);
        }

        // ãƒšãƒ¼ã‚¸åˆ†å‰²ãŒå¿…è¦ã‹ãƒã‚§ãƒƒã‚¯ã—ã€å¿…è¦ã§ã‚ã‚Œã°åˆ†å‰²
        function splitPageIfNeeded(pageContainer, originalPageNumber) {
            const pageHeight = 297; // A4ç¸¦ã®mm
            const marginTop = parseFloat(getComputedStyle(pageContainer).getPropertyValue('--page-margin-top')) || 20;
            const marginBottom = parseFloat(getComputedStyle(pageContainer).getPropertyValue('--page-margin-bottom')) || 20;
            const availableHeight = pageHeight - marginTop - marginBottom;
            
            // ä¸€æ™‚çš„ã«é«˜ã•åˆ¶é™ã‚’è§£é™¤ã—ã¦å®Ÿéš›ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„é«˜ã•ã‚’æ¸¬å®š
            pageContainer.style.maxHeight = 'none';
            pageContainer.style.overflow = 'visible';
            
            const contentHeight = pageContainer.scrollHeight;
            const maxContentHeight = availableHeight * 0.95; // å°‘ã—ä½™è£•ã‚’æŒãŸã›ã‚‹
            
            if (contentHeight <= maxContentHeight) {
                // åˆ†å‰²ä¸è¦
                pageContainer.style.maxHeight = '297mm';
                pageContainer.style.overflow = 'hidden';
                return { pageCount: 1 };
            }

            // åˆ†å‰²ãŒå¿…è¦
            return splitPageContent(pageContainer, originalPageNumber, maxContentHeight);
        }

        // ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’å®Ÿéš›ã«åˆ†å‰²
        function splitPageContent(pageContainer, originalPageNumber, maxHeight) {
            const tables = pageContainer.querySelectorAll('.usage-table');
            let pageCount = 1;
            
            tables.forEach(table => {
                const result = splitTableIfNeeded(table, pageContainer, maxHeight);
                if (result.split) {
                    pageCount += result.additionalPages;
                }
            });
            
            return { pageCount };
        }

        // ãƒ†ãƒ¼ãƒ–ãƒ«ã®åˆ†å‰²å‡¦ç†
        function splitTableIfNeeded(table, pageContainer, maxHeight) {
            const rows = table.querySelectorAll('tbody tr');
            const rowHeight = 30; // æ¦‚ç®—ã®è¡Œé«˜ã•ï¼ˆpxï¼‰
            const headerHeight = 60; // ãƒ˜ãƒƒãƒ€ãƒ¼ã®é«˜ã•
            
            const maxRowsPerPage = Math.floor((maxHeight - headerHeight) / rowHeight);
            
            if (rows.length <= maxRowsPerPage) {
                return { split: false, additionalPages: 0 };
            }

            // ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’åˆ†å‰²
            const originalTable = table.cloneNode(true);
            const thead = table.querySelector('thead').cloneNode(true);
            
            // å…ƒã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æœ€åˆã®ãƒšãƒ¼ã‚¸ç”¨ã«èª¿æ•´
            const firstPageRows = Array.from(rows).slice(0, maxRowsPerPage);
            const tbody = table.querySelector('tbody');
            tbody.innerHTML = '';
            firstPageRows.forEach(row => tbody.appendChild(row));

            // æ®‹ã‚Šã®è¡Œã§æ–°ã—ã„ãƒšãƒ¼ã‚¸ã‚’ä½œæˆ
            const remainingRows = Array.from(rows).slice(maxRowsPerPage);
            let additionalPages = 0;
            
            while (remainingRows.length > 0) {
                additionalPages++;
                const newPage = createContinuationPage(pageContainer, additionalPages);
                const newTable = createContinuationTable(thead, remainingRows.slice(0, maxRowsPerPage));
                
                newPage.appendChild(newTable);
                pageContainer.parentNode.insertBefore(newPage, pageContainer.nextSibling);
                
                remainingRows.splice(0, maxRowsPerPage);
            }

            return { split: true, additionalPages };
        }

        // ç¶™ç¶šãƒšãƒ¼ã‚¸ã®ä½œæˆ
        function createContinuationPage(originalPage, pageNumber) {
            const newPage = document.createElement('div');
            newPage.className = originalPage.className;
            newPage.innerHTML = `
                <div class="page-number-display">ãƒšãƒ¼ã‚¸ ${pageNumber + 1}</div>
                <div class="page-number">${pageNumber + 1} ãƒšãƒ¼ã‚¸</div>
            `;
            return newPage;
        }

        // ç¶™ç¶šãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆ
        function createContinuationTable(thead, rows) {
            const table = document.createElement('table');
            table.className = 'usage-table table-continuation';
            
            table.appendChild(thead);
            
            const tbody = document.createElement('tbody');
            rows.forEach(row => tbody.appendChild(row.cloneNode(true)));
            table.appendChild(tbody);
            
            return table;
        }

        // ãƒšãƒ¼ã‚¸æƒ…å ±ã®æ›´æ–°
        function updatePageInfo(totalPages) {
            pageInfo.textContent = `ãƒšãƒ¼ã‚¸ 1-${totalPages}`;
        }

        // è‡ªå‹•ãƒšãƒ¼ã‚¸åˆ†å‰²ï¼ˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„å¤‰æ›´æ™‚ï¼‰
        function autoCheckPagination() {
            // ãƒ•ã‚©ãƒ¼ãƒ å…¥åŠ›æ™‚ã«è‡ªå‹•ã§ãƒšãƒ¼ã‚¸åˆ†å‰²ã‚’ãƒã‚§ãƒƒã‚¯
            const inputs = document.querySelectorAll('input');
            inputs.forEach(input => {
                input.addEventListener('input', debounce(() => {
                    checkIfPaginationNeeded();
                }, 500));
            });
        }

        // ãƒšãƒ¼ã‚¸åˆ†å‰²ãŒå¿…è¦ã‹ãƒã‚§ãƒƒã‚¯
        function checkIfPaginationNeeded() {
            const pages = document.querySelectorAll('.page-container');
            let needsPagination = false;
            
            pages.forEach(page => {
                const contentHeight = page.scrollHeight;
                const maxHeight = 297 * 3.779527559; // mmã‚’pxã«å¤‰æ›
                
                if (contentHeight > maxHeight) {
                    needsPagination = true;
                    page.classList.add('page-overflow');
                } else {
                    page.classList.remove('page-overflow');
                }
            });
            
            if (needsPagination) {
                paginateBtn.style.backgroundColor = '#ff6b6b';
                paginateBtn.style.color = 'white';
            } else {
                paginateBtn.style.backgroundColor = '';
                paginateBtn.style.color = '';
            }
        }

        // ãƒ‡ãƒã‚¦ãƒ³ã‚¹é–¢æ•°
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // JSONãƒ‡ãƒ¼ã‚¿ã‚’ãƒ•ã‚©ãƒ¼ãƒ ã«èª­ã¿è¾¼ã‚€é–¢æ•°
        async function loadFormData() {
            try {
                const response = await fetch('form-data.json');
                if (!response.ok) {
                    console.log('form-data.jsonãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚ç©ºã®ãƒ•ã‚©ãƒ¼ãƒ ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚');
                    return;
                }
                
                const data = await response.json();
                
                // å¹´åº¦ã‚’è¨­å®š
                const yearInput = document.querySelector('.year-field input');
                if (yearInput && data.year) {
                    yearInput.value = data.year;
                }
                
                // ç”³è«‹è€…åã¨å…ç«¥åã‚’è¨­å®š
                const applicantInput = document.querySelector('.info-row:nth-child(1) .info-input');
                const childInput = document.querySelector('.info-row:nth-child(2) .info-input');
                if (applicantInput && data.applicantName) {
                    applicantInput.value = data.applicantName;
                }
                if (childInput && data.childName) {
                    childInput.value = data.childName;
                }
                
                // ãƒšãƒ¼ã‚¸1ã®ãƒ‡ãƒ¼ã‚¿ã‚’è¨­å®š
                if (data.page1) {
                    // æœˆã‚’è¨­å®š
                    const page1MonthInput = document.querySelector('#page1 .date-section input:nth-of-type(2)');
                    if (page1MonthInput && data.month) {
                        page1MonthInput.value = data.month;
                    }
                    
                    // è¡Œãƒ‡ãƒ¼ã‚¿ã‚’è¨­å®š
                    const page1Rows = document.querySelectorAll('#page1 .usage-table tbody tr:not([style*="background-color"])');
                    data.page1.rows.forEach((rowData, index) => {
                        if (page1Rows[index]) {
                            const inputs = page1Rows[index].querySelectorAll('input');
                            if (inputs[0] && rowData.date) inputs[0].value = rowData.date;
                            if (inputs[1] && rowData.dayTime) inputs[1].value = rowData.dayTime;
                            if (inputs[2] && rowData.dayDuration) inputs[2].value = rowData.dayDuration;
                            if (inputs[3] && rowData.nightTime) inputs[3].value = rowData.nightTime;
                            if (inputs[4] && rowData.nightDuration) inputs[4].value = rowData.nightDuration;
                            if (inputs[5] && rowData.amount) inputs[5].value = rowData.amount;
                        }
                    });
                    
                    // åˆè¨ˆè¡Œã‚’è¨­å®š
                    const totalRows = document.querySelectorAll('#page1 .usage-table tbody tr[style*="background-color"]');
                    if (totalRows[0]) {
                        const inputs = totalRows[0].querySelectorAll('input');
                        if (inputs[0] && data.page1.dayTotalTime) inputs[0].value = data.page1.dayTotalTime;
                        if (inputs[1] && data.page1.nightTotalTime) inputs[1].value = data.page1.nightTotalTime;
                        if (inputs[2] && data.page1.totalAmount) inputs[2].value = data.page1.totalAmount;
                    }
                    
                    // è¨ˆç®—ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¨­å®š
                    const calcInputs = document.querySelectorAll('#page1 .calculation-section input');
                    if (calcInputs[0] && data.page1.dayHours) calcInputs[0].value = data.page1.dayHours;
                    if (calcInputs[1] && data.page1.nightHours) calcInputs[1].value = data.page1.nightHours;
                    if (calcInputs[2] && data.page1.subsidyAmount) calcInputs[2].value = data.page1.subsidyAmount;
                    
                    // æ”¯æ‰•ã„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¨­å®š
                    const paymentInputs = document.querySelectorAll('#page1 .payment-section input');
                    if (paymentInputs[0] && data.page1.requestAmount) paymentInputs[0].value = data.page1.requestAmount;
                    if (paymentInputs[1] && data.page1.usageHours) paymentInputs[1].value = data.page1.usageHours;
                }
                
                // ãƒšãƒ¼ã‚¸2ã®ãƒ‡ãƒ¼ã‚¿ã‚’è¨­å®š
                if (data.page2) {
                    // ãƒ†ãƒ¼ãƒ–ãƒ«1
                    const page2Tables = document.querySelectorAll('#page2 .usage-table');
                    if (page2Tables[0] && data.page2.table1) {
                        const rows = page2Tables[0].querySelectorAll('tbody tr:not([style*="background-color"])');
                        data.page2.table1.rows.forEach((rowData, index) => {
                            if (rows[index]) {
                                const inputs = rows[index].querySelectorAll('input');
                                if (inputs[0] && rowData.date) inputs[0].value = rowData.date;
                                if (inputs[1] && rowData.dayTime) inputs[1].value = rowData.dayTime;
                                if (inputs[2] && rowData.dayDuration) inputs[2].value = rowData.dayDuration;
                                if (inputs[3] && rowData.nightTime) inputs[3].value = rowData.nightTime;
                                if (inputs[4] && rowData.nightDuration) inputs[4].value = rowData.nightDuration;
                                if (inputs[5] && rowData.amount) inputs[5].value = rowData.amount;
                            }
                        });
                    }
                    
                    // ãƒ†ãƒ¼ãƒ–ãƒ«2
                    if (page2Tables[1] && data.page2.table2) {
                        const rows = page2Tables[1].querySelectorAll('tbody tr:not([style*="background-color"])');
                        data.page2.table2.rows.forEach((rowData, index) => {
                            if (rows[index]) {
                                const inputs = rows[index].querySelectorAll('input');
                                if (inputs[0] && rowData.date) inputs[0].value = rowData.date;
                                if (inputs[1] && rowData.dayTime) inputs[1].value = rowData.dayTime;
                                if (inputs[2] && rowData.dayDuration) inputs[2].value = rowData.dayDuration;
                                if (inputs[3] && rowData.nightTime) inputs[3].value = rowData.nightTime;
                                if (inputs[4] && rowData.nightDuration) inputs[4].value = rowData.nightDuration;
                                if (inputs[5] && rowData.amount) inputs[5].value = rowData.amount;
                            }
                        });
                    }
                }
                
                console.log('ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ãŒæ­£å¸¸ã«èª­ã¿è¾¼ã¾ã‚Œã¾ã—ãŸã€‚');
            } catch (error) {
                console.error('ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
            }
        }

        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // JSONãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€
            loadFormData();
            
            // åˆæœŸã‚ºãƒ¼ãƒ ã®é©ç”¨
            changeZoom();
            
            // è‡ªå‹•ãƒšãƒ¼ã‚¸åˆ†å‰²ãƒã‚§ãƒƒã‚¯ã®åˆæœŸåŒ–
            autoCheckPagination();
            
            // åˆæœŸãƒšãƒ¼ã‚¸åˆ†å‰²ãƒã‚§ãƒƒã‚¯
            setTimeout(checkIfPaginationNeeded, 100);
            
            // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey || e.metaKey) {
                    switch(e.key) {
                        case 'p':
                            e.preventDefault();
                            printDocument();
                            break;
                        case ',':
                            e.preventDefault();
                            toggleSidebar();
                            break;
                        case 'd':
                            e.preventDefault();
                            paginateContent();
                            break;
                    }
                }
            });
        });
    </script>
</body>
</html>